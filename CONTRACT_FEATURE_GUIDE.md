# 协议设计功能说明

## ✨ 新功能：分离生成预览和复制文本

### 📋 功能概述

协议设计模块现在分为两个独立的操作：

1. **🔍 生成预览** - 先查看协议内容
2. **📋 复制文本** - 确认无误后再复制

---

## 🎯 使用流程

### 步骤 1：填写协议信息

在关键条款中填写以下信息：

**01 投资方式**
- 甲方（投资方）名称
- 投资金额（万元）
- 资产用途

**02 收益分配**
- 乙方（运营方）名称（自动填充）
- 分成比例（自动填充）
- 年化收益率（自动填充）

**03 封顶机制**
- 预期收益率（自动填充）

**04 数据传输方式**
- 频率：每月/每周/每日
- 方式：自动/手动

**05 分成付款方式**
- 频率：每月/每周/每日
- 方式：自动/手动

### 步骤 2：生成预览

1. 点击 **"生成预览"** 按钮（蓝色按钮）
2. 页面下方会展开预览区域
3. 查看生成的协议文本内容
4. 检查所有信息是否正确

### 步骤 3：复制文本

1. 确认预览内容无误后
2. 点击 **"复制文本"** 按钮（深蓝色按钮）
3. 看到提示 "✅ 已复制到剪贴板！"
4. 现在可以粘贴到其他地方使用

---

## 💡 功能亮点

### 1. **分步操作，更安全**
- ✅ 先预览再复制，避免复制错误内容
- ✅ 可以反复修改和预览，不影响剪贴板

### 2. **智能启用/禁用**
- 🔒 初始状态："复制文本"按钮为灰色禁用状态
- 🔓 生成预览后："复制文本"按钮变为可用状态
- 💡 防止用户在未生成内容时误操作

### 3. **实时预览显示**
- 📄 预览区域使用等宽字体，便于阅读
- 📏 最大高度600px，超出部分可滚动
- 🎨 带有自定义滚动条样式

### 4. **视觉反馈**
- ✅ 生成预览成功：显示 "✅ 预览已生成，可以复制文本"
- ✅ 复制成功：显示 "✅ 已复制到剪贴板！"（绿色）
- ❌ 复制失败：显示 "❌ 复制失败，请手动复制"（红色）
- ⏱️ 提示3秒后自动消失

### 5. **平滑动画**
- 🎬 预览区域滑入动画
- 🎯 自动滚动到预览区域
- 🎨 按钮悬停上浮效果

---

## 🔄 与其他功能的联动

### 自动填充功能

以下字段会自动填充到协议设计：

| 来源模块 | 字段 | 目标字段 |
|---------|------|---------|
| 被投企业筛选评估 | 企业名称 | 乙方（运营方）|
| 投资计算器 | 投资金额 | 投资金额 |
| 投资计算器 | 预期收益率 | 年化收益率 + 封顶机制预期收益率 |
| 投资计算器 | 分成比例 | 分成比例 |

**注意**：自动填充的字段仍然可以手动修改。

---

## 📝 生成的文本格式

```
投资协议关键条款

基本信息：
• 甲方（投资方）：XXX
• 乙方（运营方）：XXX
• 收入分成资产范围：XXX
• 投资金额：XXX万元
• 年化收益率（静态年化）：XX%
• 分成比例：XX%

关键条款：

01 投资方式
甲方XXX投资人民币XXX万元，用于XXX等

02 收益分配
甲方获得XXX（乙方）项目营业额的XX%作为投资回报，年化收益率XX%

03 封顶机制
滴灌通累计实际取得的收入分成金额合计达到"联营资金金额×(1+XX%÷360×已联营天数)"金额（合称"分成终止触发事项"），达到封顶，收入分成终止

04 数据传输方式
按照XXX，XXX进行数据报送

05 分成付款方式
按照XXX，XXX进行分成打款
```

---

## 🎨 界面说明

### 按钮状态

**生成预览按钮**
- 颜色：浅蓝色 (#00A3E0)
- 图标：眼睛图标 👁️
- 始终可用

**复制文本按钮**
- 初始状态：深蓝色半透明 (#003B5C, 50%)
- 生成后状态：深蓝色不透明 (#003B5C, 100%)
- 图标：复制图标 📋
- 仅在生成预览后可用

### 预览区域

- **标题**：协议文本预览 📄
- **背景**：浅灰色 (#F8F9FA)
- **边框**：双像素实线 (#E5E7EB)
- **内容**：白色背景，等宽字体
- **滚动条**：自定义蓝色滚动条

---

## 🔍 常见问题

### Q1：为什么"复制文本"按钮是灰色的？

**A：** 需要先点击"生成预览"按钮生成协议内容，才能启用复制功能。

### Q2：修改了协议内容，需要重新生成吗？

**A：** 是的，每次修改输入内容后，需要重新点击"生成预览"来更新预览内容。

### Q3：可以直接从预览区域复制文本吗？

**A：** 可以！您可以：
- 方法1：点击"复制文本"按钮（推荐）
- 方法2：在预览区域选中文本，右键复制

### Q4：复制失败怎么办？

**A：** 如果自动复制失败：
1. 在预览区域手动选中所有文本
2. 按 Ctrl+C（Windows）或 Cmd+C（Mac）复制
3. 或者右键选择"复制"

### Q5：关闭预览区域后，内容还在吗？

**A：** 预览内容会一直保留，直到您刷新页面或重新生成。"复制文本"按钮也会保持可用状态。

---

## 🚀 快速测试

**填写示例数据：**

1. 甲方：滴灌通投资（海南）有限公司
2. 投资金额：400（从投资计算器自动填充）
3. 资产用途：项目装修、设备采购、品牌加盟费
4. 乙方：肆瓦商业（从企业筛选自动填充）
5. 分成比例：35（从投资计算器自动填充）
6. 年化收益率：18（从投资计算器自动填充）
7. 数据传输：每月 + 自动
8. 分成付款：每月 + 自动

**操作流程：**

1. 点击 **"生成预览"** 
2. 查看预览内容
3. 点击 **"复制文本"**
4. 看到 "✅ 已复制到剪贴板！"
5. 粘贴到其他应用中使用

---

## 📞 技术支持

如有问题，请联系：
- 📧 Email: investment@digguantong.com
- 🐛 GitHub Issues: https://github.com/ashley-worklab/SuperFranchise_SW/issues

---

**更新日期**：2026年2月5日
